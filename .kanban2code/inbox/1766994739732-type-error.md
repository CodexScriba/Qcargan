---
stage: completed
agent: auditor
tags: []
contexts:
  - skills/nextjs-core-skills
  - skills/react-core-skills
  - skills/skill-next-intl
  - skills/skill-routing-layouts
  - skills/skill-typescript-config
  - skills/skill-vitest-playwright-testing
---

# type error

Fix any issues in the following code from file path app/[locale]/page.tsx:11-11

Current problems detected:
- [eslint] React Hook "useTranslations" cannot be called in an async function. ([object Object])


```
useTranslations
```

Please:
1. Address all detected problems listed above (if any)
2. Identify any other potential bugs or issues
3. Provide corrected code
4. Explain what was fixed and why

/home/cynic/workspace/Qcargan/app/[locale]/page.tsx

## Refined Prompt
Objective: Fix the server component translation usage in `app/[locale]/page.tsx` and align typings/tests with Next.js params conventions.

Implementation approach:
1. Replace `useTranslations` with `getTranslations` from `next-intl/server`, and update the page component to await translations without using hooks.
2. Update the `PageProps` params type (and usage) to a plain object, then adjust the test mocks and params setup to match the server API.

Key decisions:
- Use `getTranslations` on the server: avoids invalid hook usage in async server components and matches next-intl server API.

Edge cases:
- Missing translation keys: ensure default behavior is preserved (keys render as fallback in tests/mocks).

## Context
### Relevant Code
- app/[locale]/page.tsx:1 - import of `useTranslations` and async server component usage.
- app/[locale]/page.tsx:4 - params typed as a Promise rather than plain object.
- app/[locale]/page.tsx:11 - hook call inside async function triggers ESLint error.
- app/[locale]/__tests__/page.test.tsx:9 - mocks `useTranslations` which will need to change if server API is used.
- app/[locale]/__tests__/page.test.tsx:27 - params provided as a Promise, likely needs to be plain object.

### Patterns to Follow
Use server-side translations (`getTranslations`) in server components; avoid React hooks in async server functions.

### Test Patterns
`app/[locale]/__tests__/page.test.tsx` uses Vitest + RTL; mock `next-intl/server` and render the awaited page component output.

### Dependencies
- next-intl: provides `getTranslations`/`setRequestLocale` for server components.

### Gotchas
- Changing params from Promise to object requires updating both component signature and test setup.

## Audit
- app/[locale]/page.tsx
- app/[locale]/__tests__/page.test.tsx
